CREATE DATABASE IF NOT EXISTS `P04_queries01` DEFAULT CHARACTER SET utf8mb4 COLLATE
utf8mb4_general_ci;
USE `P04_queries01`;
DROP TABLE IF EXISTS `DEPARTMENTS`;
CREATE TABLE `DEPARTMENTS` (
`num` int(11) NOT NULL,
`name` varchar(30) NOT NULL,
`town_code` varchar(3) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
INSERT INTO `DEPARTMENTS` (`num`, `name`, `town_code`) VALUES
(10, 'ACCOUNTING', 'SVQ'),
(20, 'RESEARCH', 'MAD'),
(30, 'SALES', 'BCN'),
(40, 'PRODUCTION', 'BIO');
DROP TABLE IF EXISTS `EMPLOYEES`;
CREATE TABLE `EMPLOYEES` (
`num` int(11) NOT NULL,
`surname` varchar(50) NOT NULL,
`name` varchar(50) NOT NULL,
`manager` int(11) DEFAULT NULL,
`start_date` date DEFAULT NULL,
`salary` int(11) DEFAULT NULL,
`commission` int(11) DEFAULT NULL,
`dept_num` int(11) DEFAULT NULL,
`occu_code` varchar(3) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
INSERT INTO `EMPLOYEES` (`num`, `surname`, `name`, `manager`, `start_date`, `salary`,
`commission`, `dept_num`, `occu_code`) VALUES
(800, 'BANDERAS', 'ANTONIO', NULL, '1991-01-09', 2885, NULL, 20, NULL),
(7369, 'SÁNCHEZ', 'SERGIO', 7902, '1990-12-17', 1040, NULL, NULL, NULL),
(7499, 'ARROYO', 'MARTA', 7698, '1990-02-20', 1500, 390, 30, 'SAL'),
(7521, 'AGUILO', 'JOSEP', 7698, '1991-02-22', 1625, 650, 30, 'SAL'),
(7566, 'AROCA', 'JUDIT', 7839, '1991-04-02', 2900, NULL, 20, 'MAN'),
(7654, 'MARTÍN', 'MONICA', 7698, '1991-09-29', 1600, 1020, 30, 'SAL'),
(7698, 'AMER', 'BARTOLOME', 7839, '1991-05-01', 3005, NULL, 30, NULL),
(7782, 'COLOM', 'ENRIQUE', 7839, '1991-06-09', 2885, NULL, 10, 'MAN'),
(7788, 'GIL', 'JAVIER', 7566, '1991-11-09', 3000, NULL, 20, 'ANA'),
(7844, 'TOVAR', 'LUIS', 7698, '1991-09-08', 1350, 0, 30, 'SAL'),
(7876, 'ALONSO', 'FERNANDO', 7788, '1991-09-23', 1430, NULL, 20, 'EMP'),
(7900, 'JIMENO', 'XAVIER', 7698, '1991-12-03', 1335, NULL, 30, 'EMP'),
(7902, 'FERNÁNDEZ', 'ANA', 7566, '1991-12-03', 3000, NULL, NULL, 'ANA'),
(7934, 'MUÑOZ', 'ANTONIA', 7782, '1992-01-23', 1690, NULL, 10, 'EMP'),
(8001, 'RUIZ', 'FERNANDA', 7839, '1992-06-10', 2885, NULL, 20, 'MAN');
DROP TABLE IF EXISTS `OCCUPATIONS`;
CREATE TABLE `OCCUPATIONS` (
`code` varchar(3) NOT NULL,
`name` varchar(30) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
INSERT INTO `OCCUPATIONS` (`code`, `name`) VALUES
('ANA', 'ANALYST'),
('EMP', 'EMPLOYEE'),
('MAN', 'MANAGER'),
('PRE', 'PRESIDENT'),
('SAL', 'SALESMAN');

DROP TABLE IF EXISTS `TOWNS`;
CREATE TABLE `TOWNS` (
`code` varchar(3) NOT NULL,
`name` varchar(30) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
INSERT INTO `TOWNS` (`code`, `name`) VALUES
('BCN', 'BARCELONA'),
('BIO', 'BILBAO'),
('MAD', 'MADRID'),
('SVQ', 'SEVILLA');
ALTER TABLE `DEPARTMENTS`
ADD PRIMARY KEY (`num`),
ADD KEY `town_code` (`town_code`);
ALTER TABLE `EMPLOYEES`
ADD PRIMARY KEY (`num`),
ADD KEY `dept_num` (`dept_num`),
ADD KEY `occu_code` (`occu_code`);
ALTER TABLE `OCCUPATIONS`
ADD PRIMARY KEY (`code`);
ALTER TABLE `TOWNS`
ADD PRIMARY KEY (`code`);
ALTER TABLE `DEPARTMENTS`
ADD CONSTRAINT `DEPARTMENTS_ibfk_1` FOREIGN KEY (`town_code`) REFERENCES `TOWNS`
(`code`);
ALTER TABLE `EMPLOYEES`
ADD CONSTRAINT `EMPLOYEES_ibfk_1` FOREIGN KEY (`dept_num`) REFERENCES `DEPARTMENTS`
(`num`),
ADD CONSTRAINT `EMPLOYEES_ibfk_2` FOREIGN KEY (`occu_code`) REFERENCES `OCCUPATIONS`
(`code`);
COMMIT;